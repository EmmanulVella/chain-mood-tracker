# Chain Mood Tracker - FHEVM é“¾ä¸Šå¿ƒæƒ…è®°å½•DApp

ä¸€ä¸ªåŸºäºFHEVMçš„å…¨åŒæ€åŠ å¯†é“¾ä¸Šå¿ƒæƒ…è®°å½•åº”ç”¨ï¼Œè®©ç”¨æˆ·å¯ä»¥å®‰å…¨ã€ç§å¯†åœ°è®°å½•æ¯å¤©çš„å¿ƒæƒ…ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

- **éšç§ä¿æŠ¤**: ä½¿ç”¨FHEVMå…¨åŒæ€åŠ å¯†ï¼Œä¿æŠ¤ç”¨æˆ·å¿ƒæƒ…æ•°æ®çš„éšç§
- **æ¯æ—¥è®°å½•**: æ”¯æŒæ¯å¤©è®°å½•ä¸€ä¸ªå¿ƒæƒ…è¡¨æƒ…å’Œæ–‡å­—æè¿°
- **å¿ƒæƒ…é“¾**: å½¢æˆç”¨æˆ·ä¸ªäººçš„å¿ƒæƒ…æ—¶é—´çº¿
- **ç¾è§‚ç•Œé¢**: ç°ä»£åŒ–çš„æ¸å˜è®¾è®¡å’Œå¡ç‰‡å¼å¸ƒå±€
- **å®æ—¶è§£å¯†**: æ”¯æŒå¯¹åŠ å¯†å¿ƒæƒ…æ•°æ®çš„å®æ—¶è§£å¯†æŸ¥çœ‹

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ™ºèƒ½åˆçº¦ (FHEVM)
- **MoodTracker.sol**: ä¸»è¦åˆçº¦ï¼Œå¤„ç†å¿ƒæƒ…è®°å½•å­˜å‚¨å’ŒåŠ å¯†
- **æ”¯æŒçš„åŠ å¯†ç±»å‹**: euint8 (è¡¨æƒ…ç´¢å¼•), euint256 (æ¶ˆæ¯å“ˆå¸Œ)
- **è®¿é—®æ§åˆ¶**: ä½¿ç”¨FHEVM ACLæ§åˆ¶æ•°æ®è®¿é—®æƒé™

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Next.js 15**: Reactæ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨
- **Tailwind CSS**: ç°ä»£åŒ–æ ·å¼
- **@zama-fhe/relayer-sdk**: FHEVM Relayer SDK
- **@fhevm/mock-utils**: æœ¬åœ°å¼€å‘Mockå·¥å…·

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- npm æˆ– yarn
- MetaMaské’±åŒ…

### 1. å¯åŠ¨æœ¬åœ°HardhatèŠ‚ç‚¹

```bash
cd fhevm-hardhat-template
npm install
npx hardhat node --verbose
```

### 2. éƒ¨ç½²åˆçº¦

åœ¨æ–°ç»ˆç«¯çª—å£ï¼š
```bash
cd fhevm-hardhat-template
npx hardhat deploy --network localhost
```

### 3. å¯åŠ¨å‰ç«¯åº”ç”¨

åœ¨æ–°ç»ˆç«¯çª—å£ï¼š
```bash
cd frontend
npm install
npm run dev:mock
```

### 4. è¿æ¥å¹¶ä½¿ç”¨

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`
2. è¿æ¥MetaMaské’±åŒ…
3. é€‰æ‹©å¿ƒæƒ…è¡¨æƒ…å¹¶è¾“å…¥æ–‡å­—æè¿°
4. ç‚¹å‡»"Record My Mood"è®°å½•å¿ƒæƒ…
5. æŸ¥çœ‹å¿ƒæƒ…å†å²è®°å½•

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### è®°å½•å¿ƒæƒ…
1. é€‰æ‹©ä¸€ä¸ªè¡¨æƒ…ç¬¦å· (ğŸ˜ŠğŸ˜¢ğŸ˜¡ğŸ˜´ğŸ¤”ğŸ˜ğŸ¤—ğŸ˜±ğŸ‰â¤ï¸)
2. è¾“å…¥å¿ƒæƒ…æè¿°æ–‡å­—
3. ç‚¹å‡»è®°å½•æŒ‰é’®
4. æ¯å¤©åªèƒ½è®°å½•ä¸€æ¬¡å¿ƒæƒ…

### æŸ¥çœ‹å†å²
- åº”ç”¨ä¼šè‡ªåŠ¨åŠ è½½æœ€è¿‘7å¤©çš„è®°å½•
- åŠ å¯†çš„å¿ƒæƒ…æ•°æ®æ˜¾ç¤ºä¸ºğŸ”’å›¾æ ‡
- ç‚¹å‡»"Decrypt"æŒ‰é’®å¯ä»¥è§£å¯†æŸ¥çœ‹å…·ä½“å†…å®¹

### éšç§ä¿æŠ¤
- æ‰€æœ‰å¿ƒæƒ…æ•°æ®éƒ½ç»è¿‡FHEVMåŠ å¯†å­˜å‚¨
- åªæœ‰æ•°æ®æ‰€æœ‰è€…å¯ä»¥è§£å¯†æŸ¥çœ‹
- åŒºå—é“¾ä¸Šåªèƒ½çœ‹åˆ°åŠ å¯†åçš„å¯†æ–‡

## ğŸ”§ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ fhevm-hardhat-template/     # æ™ºèƒ½åˆçº¦é¡¹ç›®
â”‚   â”œâ”€â”€ contracts/
â”‚   â”‚   â””â”€â”€ MoodTracker.sol     # å¿ƒæƒ…è®°å½•åˆçº¦
â”‚   â”œâ”€â”€ deploy/
â”‚   â”‚   â””â”€â”€ deploy.ts           # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ test/                   # åˆçº¦æµ‹è¯•
â”œâ”€â”€ frontend/                   # Next.jså‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ abi/                    # åˆçº¦ABIæ–‡ä»¶
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ MoodTrackerDemo.tsx # ä¸»UIç»„ä»¶
â”‚   â”œâ”€â”€ fhevm/                  # FHEVMé›†æˆä»£ç 
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useMoodTracker.tsx  # å¿ƒæƒ…è®°å½•Hook
â”‚   â””â”€â”€ app/
â”‚       â””â”€â”€ page.tsx            # ä¸»é¡µé¢
â””â”€â”€ README_MoodTracker.md       # é¡¹ç›®è¯´æ˜
```

## ğŸ” FHEVMé›†æˆè¯¦è§£

### åˆçº¦è®¾è®¡
```solidity
contract MoodTracker is SepoliaConfig {
    struct MoodEntry {
        address user;
        euint32 timestamp;      // åŠ å¯†æ—¶é—´æˆ³
        euint8 emoji;          // åŠ å¯†è¡¨æƒ…ç´¢å¼•
        euint256 messageHash;   // åŠ å¯†æ¶ˆæ¯å“ˆå¸Œ
        bool exists;
    }

    mapping(address => mapping(uint32 => MoodEntry)) private _userMoods;
}
```

### å‰ç«¯é›†æˆ
```typescript
// åŠ å¯†è¾“å…¥åˆ›å»º
const input = instance.createEncryptedInput(contractAddress, userAddress);
input.add8(emojiIndex);
input.add256(messageHash);
const enc = await input.encrypt();

// åˆçº¦è°ƒç”¨
await contract.recordMood(enc.handles[0], enc.handles[1], enc.inputProof, enc.inputProof);
```

## ğŸ§ª Mockæ¨¡å¼å¼€å‘

é¡¹ç›®æ”¯æŒæœ¬åœ°Mockæ¨¡å¼ï¼Œæ— éœ€çœŸå®FHEVMç½‘ç»œå³å¯å¼€å‘ï¼š

```bash
npm run dev:mock  # è‡ªåŠ¨å¯åŠ¨hardhatèŠ‚ç‚¹å¹¶éƒ¨ç½²åˆçº¦
```

Mockæ¨¡å¼ç‰¹ç‚¹ï¼š
- æœ¬åœ°æ¨¡æ‹ŸFHEVMåŠŸèƒ½
- å¼€å‘æ—¶æ— éœ€ç½‘ç»œè¿æ¥
- ç”Ÿäº§æ„å»ºæ—¶è‡ªåŠ¨æ’é™¤Mockä»£ç 

## ğŸ¨ ç•Œé¢è®¾è®¡

### è®¾è®¡ç†å¿µ
- **æ¸å˜èƒŒæ™¯**: ä»è“è‰²åˆ°ç´«è‰²çš„ä¼˜é›…æ¸å˜
- **å¡ç‰‡å¸ƒå±€**: ç°ä»£åŒ–çš„åœ†è§’å¡ç‰‡è®¾è®¡
- **è¡¨æƒ…é€‰æ‹©**: å¤§å°ºå¯¸çš„è¡¨æƒ…ç¬¦å·é€‰æ‹©å™¨
- **çŠ¶æ€æŒ‡ç¤º**: æ¸…æ™°çš„æ“ä½œçŠ¶æ€åé¦ˆ
- **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡

### é¢œè‰²æ–¹æ¡ˆ
- ä¸»è‰²è°ƒ: è“è‰²åˆ°ç´«è‰²æ¸å˜ (#3B82F6 â†’ #8B5CF6)
- æˆåŠŸçŠ¶æ€: ç»¿è‰² (#10B981)
- è­¦å‘ŠçŠ¶æ€: æ©™è‰² (#F59E0B)
- é”™è¯¯çŠ¶æ€: çº¢è‰² (#EF4444)

## ğŸ”„ å·¥ä½œæµç¨‹

1. **è¿æ¥é’±åŒ…** â†’ ç”¨æˆ·è¿æ¥MetaMask
2. **åˆå§‹åŒ–FHEVM** â†’ åŠ è½½Relayer SDK
3. **é€‰æ‹©è¡¨æƒ…** â†’ ç”¨æˆ·é€‰æ‹©å¿ƒæƒ…è¡¨æƒ…
4. **è¾“å…¥æ–‡å­—** â†’ ç”¨æˆ·è¾“å…¥å¿ƒæƒ…æè¿°
5. **åŠ å¯†å¤„ç†** â†’ å‰ç«¯ç”ŸæˆåŠ å¯†è¾“å…¥
6. **é“¾ä¸Šå­˜å‚¨** â†’ è°ƒç”¨åˆçº¦è®°å½•å¿ƒæƒ…
7. **æŸ¥çœ‹å†å²** â†’ åŠ è½½å¹¶æ˜¾ç¤ºå¿ƒæƒ…è®°å½•
8. **è§£å¯†æŸ¥çœ‹** â†’ ç”¨æˆ·å¯ä»¥è§£å¯†è‡ªå·±çš„è®°å½•

## ğŸš€ éƒ¨ç½²åˆ°æµ‹è¯•ç½‘

### Sepoliaæµ‹è¯•ç½‘éƒ¨ç½²

1. è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export MNEMONIC="your mnemonic here"
export INFURA_API_KEY="your infura key"
```

2. éƒ¨ç½²åˆ°Sepoliaï¼š
```bash
npx hardhat deploy --network sepolia
```

3. æ›´æ–°åœ°å€æ–‡ä»¶ï¼š
```typescript
// frontend/abi/MoodTrackerAddresses.ts
export const MoodTrackerAddresses = {
  "11155111": { address: "0x...", chainId: 11155111, chainName: "sepolia" },
  "31337": { address: "0x...", chainId: 31337, chainName: "hardhat" },
};
```

## ğŸ”§ å¼€å‘å‘½ä»¤

```bash
# åˆçº¦å¼€å‘
npm run compile          # ç¼–è¯‘åˆçº¦
npm run test            # è¿è¡Œæµ‹è¯•
npm run deploy:localhost # æœ¬åœ°éƒ¨ç½²
npm run deploy:sepolia   # Sepoliaéƒ¨ç½²

# å‰ç«¯å¼€å‘
npm run dev             # å¼€å‘æ¨¡å¼
npm run dev:mock        # Mockæ¨¡å¼
npm run build           # ç”Ÿäº§æ„å»º
npm run lint            # ä»£ç æ£€æŸ¥
```

## ğŸ“ˆ æ‰©å±•åŠŸèƒ½

æœªæ¥å¯ä»¥æ·»åŠ çš„åŠŸèƒ½ï¼š
- å¿ƒæƒ…ç»Ÿè®¡åˆ†æ
- ç¤¾äº¤åŠŸèƒ½ï¼ˆåˆ†äº«åŒ¿åå¿ƒæƒ…ç»Ÿè®¡ï¼‰
- å¤šé“¾æ”¯æŒ
- é«˜çº§åŠ å¯†é€‰é¡¹
- å¿ƒæƒ…é¢„æµ‹AI
- NFTå¿ƒæƒ…å¾½ç« 

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. å‘èµ·Pull Request

## ğŸ“„ è®¸å¯è¯

BSD-3-Clause-Clear License

## ğŸ™ è‡´è°¢

- [Zama](https://www.zama.ai/) - FHEVMæŠ€æœ¯æä¾›è€…
- [Hardhat](https://hardhat.org/) - ä»¥å¤ªåŠå¼€å‘ç¯å¢ƒ
- [Next.js](https://nextjs.org/) - Reactæ¡†æ¶
- [Tailwind CSS](https://tailwindcss.com/) - CSSæ¡†æ¶
